Account - scott

2019/12/23
--1)EMP와 DEPT Table을 조인하여 부서번호, 부서명, 이름, 급여를 출력하라.
--ANSI
SELECT e.deptno, d.dname, e.ename, e.sal
FROM emp e 
INNER JOIN dept d
ON e.deptno = d.deptno;

--ORACLE
SELECT e.deptno, d.dname, e.ename, e.sal
FROM emp e, dept d
WHERE e.deptno = d.deptno;

--2)이름이 'ALLEN'인 사원의 부서명을 출력하라.
--ANSI
SELECT e.ename, d.dname
FROM emp e
INNER JOIN dept d 
ON e.deptno = d.deptno
WHERE e.ename = 'ALLEN';

--ORACLE
SELECT e.ename, d.dname
FROM emp e, dept d
WHERE e.deptno = d.deptno
AND e.ename='ALLEN';

--3)DEPT Table에 있는 모든 부서를 출력하고, EMP Table에 있는 DATA와 JOIN하여 모든 사원의 이름, 부서번호, 부서명, 급여를 출력하라.
--ANSI
SELECT e.ename, e.deptno, d.dname, e.sal
FROM emp e
RIGHT OUTER JOIN dept d
ON e.deptno = d.deptno;

--ORACLE
SELECT e.ename, e.deptno, d.dname, e.sal
FROM emp e, dept d
WHERE e.deptno(+) = d.deptno;

--4)EMP Table에 있는 EMPNO와 MGR을 이용하여 서로의 관계를 다음과 같이 출력하라.
--SMITH의 매니저는 FORD이다.
--ANSI
SELECT e.ename || '의 매니저는' || m.ename || '이다.'
FROM emp e
JOIN emp m
ON e.mgr = m.empno
WHERE e.ename = 'SMITH';

--ORACLE
SELECT e.ename || '의 매니저는' || m.ename || '이다.'
FROM emp e, emp m
WHERE e.mgr = m.empno
AND e.ename='SMITH';

--5)'ALLEN'의 직무와 같은 사람의 이름, 부서명, 급여, 직무를 출력하라.
--ANSI
SELECT e.ename, d.dname, e.sal, e.job
FROM emp e
JOIN dept d
ON e.deptno = d.deptno
WHERE job = (SELECT job FROM emp WHERE ename ='ALLEN');

--ORACLE
SELECT e.ename, d.dname, e.sal, e.job
FROM emp e, dept d
WHERE e.deptno = d.deptno
AND job = (SELECT job 
           FROM emp 
           WHERE ename ='ALLEN');

--6)'JONES'가 속해있는 부서의 모든사람의 사원번호, 이름, 입사일, 급여를 출력하라.
SELECT empno, ename, hiredate, sal
FROM emp
WHERE deptno = (SELECT deptno 
                FROM emp
                WHERE ename='JONES');

--7)전체 사원의 평균임금보다 많은 사원의 사원번호, 이름, 부서명, 입사일, 지역, 급여를출력하라.
SELECT e.empno, e.ename, d.dname, e.hiredate, d.loc, e.sal
FROM emp e, dept d
WHERE e.deptno = d.deptno
AND SAL > (SELECT AVG(SAL)
           FROM emp);

--8)10번 부서의 사람들중에서 20번 부서의 사원과 같은 업무를 하는 사원의 사원번호, 이름, 부서명, 입사일, 지역을 출력하라.
SELECT e.empno, e.ename, d.dname, e.hiredate, d.loc
FROM emp e, dept d
WHERE e.deptno = d.deptno
AND e.deptno = 10
AND e.job
IN (SELECT job
    FROM emp
    WHERE deptno=20);
    

2019/12/24
--1. EMP테이블에서 모든 사원에 대한 이름(ename), 부서번호(deptno) DEPT테이블에서 부서명(dname)을 출력하는 문장을 작성
SELECT e.ename, e.deptno, d.dname
FROM emp e, dept d
WHERE e.deptno = d.deptno;

--2. DEPT테이블의 LOC가 NEW YORK에서 근무하고 있는 사원에 대하여 EMP 테이블의  이름(ename), 업무(job), 급여(sal), DEPT테이블의 부서명(dname) 
--을 출력하는 SELECT 문장을 작성
SELECT e.ename, e.job, e.sal, d.dname
FROM emp e, dept d
WHERE e.deptno = d.deptno
AND d.loc='NEW YORK';

--3. EMP테이블에서 보너스(comm)가 null이 아닌 사원에 대하여 이름(ename) 테이블의 부서명(dname), 위치(loc)를 출력하는 SELECT문장을 작성
SELECT e.ename, d.dname, d.loc
FROM emp e, dept d
WhERE e.deptno = d.deptno
AND e.comm is NOT NULL;

--4. EMP테이블에서 이름(ename) 중 L자가 있는 사원에 대하여 이름(ename), 업무(job), DEPT테이블의 부서명(dname), 위치(loc)를 출력하는
--SELECT 문장을 작성
SELECT e.ename, e.job, d.dname, d.loc
FROM emp e, dept d
WHERE e.deptno = d.deptno
AND e.ename LIKE '%L%';

--5. EMP테이블에서 그들의 관리자(mgr) 보다 먼저 입사한 사원에 대하여 이름(ename), 입사일(hiredate), 관리자(mgr) 이름, 관리자(mgr)
--입사일을 출력하는 문장을 작성하여라
SELECT e.ename, e.hiredate, m.ename, m.hiredate
FROM emp e, emp m
WHERE e.mgr = m.empno
AND e.hiredate < m.hiredate;
